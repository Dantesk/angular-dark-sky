!function(){"use strict";function e(){var e,t={baseUri:"https://api.darksky.net/forecast/",baseExclude:"&exclude=",acceptedUnits:["auto","ca","uk2","us","si"],acceptedLanguage:["ar","az","be","bs","cs","de","el","en","es","fr","hr","hu","id","it","is","kw","nb","nl","pl","pt","ru","sk","sr","sv","tet","tr","uk","x-pig-latin","zh","zh-tw"]},n="us",r="en";this.setApiKey=function(t){return e=t,this},this.setUnits=function(e){return-1===_.indexOf(t.acceptedUnits,e)&&console.warn(e+" not an accepted api unit"),n=e,this},this.setLanguage=function(e){return-1===_.indexOf(t.acceptedLanguage,e)&&console.warn(e+" not an accepted api language"),r=e,this},this.$get=["$http","$q",function(i,a){function u(e,t){return d(e,t).current()}function c(e,t){return d(e,t).daily()}function s(e,t){return d(e,t).hourly()}function o(e,t){return d(e,t).minutely()}function l(e,t){return d(e,t).alerts()}function p(e,t){return d(e,t).flags()}function f(){var e,t="us";switch(n&&("auto"===n?(console.warn("Can't guess units. Defaulting to Imperial"),t="us"):t=n),t){case"ca":e=k();break;case"uk2":e=v();break;case"us":e=h();break;case"si":e=g()}return e}function d(e,t){return{current:function(){var n=m("currently");return y(e,t,n)},daily:function(){var n=m("daily");return y(e,t,n)},hourly:function(){var n=m("hourly");return y(e,t,n)},minutely:function(){var n=m("minutely");return y(e,t,n)},alerts:function(){var n=m("alerts");return y(e,t,n)},flags:function(){var n=m("flags");return y(e,t,n)}}}function m(e){var n=["alerts","currently","daily","flags","hourly","minutely"],r=_.filter(n,e),i=_.join(r,",");return t.baseExclude+i}function y(u,c,s){var o=[t.baseUri,e,"/",u,",",c,"?units=",n,"&lang=",r,s,"&callback=JSON_CALLBACK"].join("");return i.jsonp(o).then(function(e){return 200===parseInt(e.status)?e.data:a.reject(e)})["catch"](function(e,t){return a.reject(t)})}function h(){return{nearestStormDistance:"mi",precipIntensity:"in/h",precipIntensityMax:"in/h",precipAccumulation:"in",temperature:"f",temperatureMin:"f",temperatureMax:"f",apparentTemperature:"f",dewPoint:"f",windSpeed:"mph",pressure:"mbar",visibility:"mi"}}function g(){return{nearestStormDistance:"km",precipIntensity:"mm/h",precipIntensityMax:"mm/h",precipAccumulation:"cm",temperature:"c",temperatureMin:"c",temperatureMax:"c",apparentTemperature:"c",dewPoint:"c",windSpeed:"mps",pressure:"hPa",visibility:"km"}}function k(){var e=h();return e.windSpeed="km/h",e}function v(){var e=g();return e.nearestStormDistance=e.visibility="mi",e.windSpeed="mph",e}var b={getCurrent:u,getForecast:c,getDailyForecast:c,getForecastHourly:s,getForecastMinutely:o,getAlerts:l,getFlags:p,getUnits:f};return e||console.warn("No Dark Sky API key set."),b}]}function t(){return{restrict:"E",scope:{icon:"@"},template:'<i class="wi wi-forecast-io-{{ icon }}"></i>'}}angular.module("dark-sky",[]).provider("darkSky",e).directive("darkSkyIcon",["darkSky",t])}();